<%- include('./agentMenu.ejs', {agent: agent}); %>
<script>
  function checkSetting() {
    alert("ë³€ê²½ ì‚¬í•­ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
    return true;
  }

  function checkPassword() {
    let pw = document.getElementById("newpw").value;
    let pw2 = document.getElementById("newpw2").value;
    let passwordMessage = document.getElementById("checkpw");
    const minLength = 8;
    const hasUppercase = /[A-Z]/.test(pw);
    const hasLowercase = /[a-z]/.test(pw);
    const hasNumber = /[0-9]/.test(pw);
    const hasSpecial = /^(?=.*[!@#%&])/.test(pw);
    if (pw !== pw2) {
      passwordMessage.innerText =
        "ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.";
      return false;
    } else if (pw.length < minLength) {
      passwordMessage.innerText = `ë¹„ë°€ë²ˆí˜¸ëŠ” ${minLength}ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.`;
    } else if (!hasUppercase) {
      passwordMessage.innerText = "ë¹„ë°€ë²ˆí˜¸ì—ëŠ” ëŒ€ë¬¸ìê°€ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.";
    } else if (!hasLowercase) {
      passwordMessage.innerText = "ë¹„ë°€ë²ˆí˜¸ì—ëŠ” ì†Œë¬¸ìê°€ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.";
    } else if (!hasNumber) {
      passwordMessage.innerText = "ë¹„ë°€ë²ˆí˜¸ì—ëŠ” ìˆ«ìê°€ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.";
    } else if (!hasSpecial) {
      passwordMessage.innerText = "ë¹„ë°€ë²ˆí˜¸ì—ëŠ” íŠ¹ìˆ˜ê¸°í˜¸ê°€ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤";
    } else {
      passwordMessage.innerText = "";
      return true;
    }
    return false;
  }
</script>
<div class="mypage-container">
  <h3 class="mypage-hr">ê³„ì • ì •ë³´</h3>
  <form classname="user-setting" action="/agent/settings/update" method="post">
    <label class="user-label">ğŸ§¸ ì•„ì´ë””</label>
    <input class="uk-input uk-form-width-medium" name="username" value="<%= agent.a_username %>" placeholder="ì•„ì´ë””" readonly="true" />
    <br />
    <label class="user-label">âœ… ì‹¤ëª…</label>
    <input class="uk-input uk-form-width-medium" value="<%= agent.a_realname %>" required />
    <br />
    <label class="user-label">ğŸ“¬ ì´ë©”ì¼</label>
    <input class="uk-input uk-form-width-medium" name="email" value="<%= agent.a_email %>" type="email" />
    <br />
    <button class="user-submit-button uk-button uk-button-default" type="submit" onclick="return checkSetting()">
      ë³€ê²½ ë‚´ìš© ì €ì¥í•˜ê¸°
    </button>
  </form>
  <br />

  <h3 class="mypage-hr">ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •</h3>
  <form action="/agent/settings/pwupdate" method="post">
    <label class="user-label">ğŸ”‘ í˜„ì¬ ë¹„ë°€ë²ˆí˜¸</label>
    <div class="uk-inline">
      <span class="uk-form-icon uk-form-icon-flip" uk-icon="icon: lock"></span>
      <input class="uk-input uk-form-width-medium" name="oldpassword" type="password" aria-label="Not clickable icon" required />
    </div>
    <br />

    <label class="user-label">ğŸ”“ ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
    <div class="uk-inline">
      <span class="uk-form-icon uk-form-icon-flip" uk-icon="icon: lock"></span>
      <input id="newpw" name="password" class="uk-input uk-form-width-medium" type="password" aria-label="Not clickable icon" required />
    </div>
    <br />
    <label class="user-label">ğŸ”’ ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
    <div class="uk-inline">
      <span class="uk-form-icon uk-form-icon-flip" uk-icon="icon: lock"></span>
      <input id="newpw2" class="uk-input uk-form-width-medium" type="password" aria-label="Not clickable icon" required />
    </div>
    <label id="checkpw"></label>
    <br />
    <button class="user-submit-button uk-button uk-button-default" type="submit" onclick="return checkPassword()">
      ë¹„ë°€ë²ˆí˜¸ ë³€ê²½í•˜ê¸°
    </button>
  </form>
</div>